- 不同局域网的两台机器无法直接通信，这是由于公网IP有限，内网机器都是由网关动态分配的私网IP,在外网无法进行ip路由。
- NAT网关
作用：一般把内网的主机叫做是客户端，公网的主机叫做是服务器,就是常见的CS模式。数据包从一台内网机器发出后，会根据ip协议进行路由跳转，直到数据包到达NAT网关，NAT网关位于公网与内网之间，由于在内网ip是私有ip，公网的路由只能路由公网IP，所以数据包必须在NAT网关这里进行ip转换。
转换规则：NAT网关会把ip包中的源ip换成NAT网关的公网IP，把tcp包或者udp包的源端口换成一个NAT机器上新分配的端口nat_port_x（NAPT），并且记录转换规则。这样NAT网关内部就维护了一条规则：```源IP（client）+端口 <-> NAT IP+nat_port_x <-> 目的IP（server）+端口 ```意味着server端发给NAT IP+nat_port_x的数据包会被NAT转发给内网的那台机器。
- NAT穿透（打洞）
从上面NAT网关的转换过程可以看到，外网的机器想要与内网的机器通信，首先需要在NAT网关上建立一条类似的转换规则，NAT才会对相应的数据包进行路由转发，也即在内网上打了一个洞，打洞的动作是由内网的机器发起，并且其他外部IP不能利用这个洞。
- 除此之外，NAT穿透也多见于其他场合，多是屏蔽内部细节，统一暴露出口，比如K8s集群中service-pod之间，不同node下的pod之间通信，由kube-proxy维护iptable表实现NAT穿透。